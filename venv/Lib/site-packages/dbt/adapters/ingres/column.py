from dbt.adapters.base import Column


class IngresColumn(Column):
    @property
    def data_type(self):
        # on ingres, do not convert 'text' or 'varchar' to 'varchar()'
        if self.is_string():
            return self.string_type(self.string_size())
        return super().data_type
    
    def string_size(self) -> int:
        if not self.is_string():
            raise DbtRuntimeError("Called string_size() on non-string field!")

        if self.dtype == "text" or self.char_size is None:
            # char_size should never be None. Handle it reasonably just in case
            return 256
        else:
            return int(self.char_size)
